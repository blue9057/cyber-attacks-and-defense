The program wipes envp. Can you put your shellcode on the stack and execute that?
